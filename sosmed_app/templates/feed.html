<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feed</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='main-styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
.main-content .posts-container {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-lg);
  max-width: 800px;
  margin: 0 auto;
}

/* ===== FEED POST CARD ===== */
.main-content .post {
  background: linear-gradient(135deg, rgba(21, 21, 21, 0.95) 0%, rgba(26, 26, 26, 0.9) 100%);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-xl);
  padding: var(--spacing-xl);
  transition: all var(--transition-smooth);
  box-shadow: var(--shadow-md);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  margin: 0 var(--spacing-xs);
  position: relative;
  overflow: hidden;
}

.main-content .post:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-lg);
  border-color: var(--color-border-hover);
}

.main-content .post::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--color-primary), var(--color-accent));
  opacity: 0;
  transition: opacity var(--transition-base);
}

.main-content .post:hover::before {
  opacity: 1;
}

/* ===== FEED POST HEADER - MOBILE FIRST ===== */
.main-content .post-header {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: flex-start;
  gap: var(--spacing-lg);
  margin-bottom: var(--spacing-lg);
}

.main-content .post-author {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  flex: 1;
}

.main-content .post-avatar {
  width: 48px;
  height: 48px;
  border-radius: var(--radius-full);
  object-fit: cover;
  flex-shrink: 0;
  border: 2px solid var(--color-primary);
  box-shadow: var(--shadow-sm);
}

.main-content .author-info {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
  flex: 1;
  min-width: 0; /* Allow text to wrap */
}

.main-content .author-info a {
  text-decoration: none;
  transition: color var(--transition-base);
}

.main-content .author-info a:hover {
  color: var(--color-primary);
}

.main-content .author-name {
  font-weight: 600;
  color: var(--color-text);
  font-size: var(--font-base);
  transition: color var(--transition-base);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.main-content .author-info a:hover .author-name {
  color: var(--color-primary);
}

.main-content .author-username {
  color: var(--color-text-secondary);
  font-size: var(--font-sm);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.main-content .post-time {
  color: var(--color-text-muted);
  font-size: var(--font-sm);
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
  padding: var(--spacing-xs) var(--spacing-sm);
  background: transparent;
  border-radius: var(--radius-md);
  white-space: nowrap;
  flex-shrink: 0;
}

.main-content .post-time i {
  font-size: var(--font-xs);
}

/* ===== FEED POST CONTENT ===== */
.main-content .post-content {
  margin-bottom: var(--spacing-lg);
}

.main-content .post-content p {
  margin: 0 0 var(--spacing-lg) 0;
  line-height: 1.7;
  color: var(--color-text);
  font-size: var(--font-base);
}

.main-content .post-image {
  margin-top: var(--spacing-lg);
}

.main-content .post-image img {
  max-width: 100%;
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-border);
  box-shadow: var(--shadow-md);
  transition: all var(--transition-base);
}

.main-content .post-image img:hover {
  transform: scale(1.02);
  box-shadow: var(--shadow-lg);
}

/* ===== EMPTY FEED STATE ===== */
.main-content .empty-feed {
  text-align: center;
  padding: var(--spacing-3xl);
  background: linear-gradient(135deg, rgba(21, 21, 21, 0.9) 0%, rgba(26, 26, 26, 0.8) 100%);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-xl);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  margin: 0 var(--spacing-xs);
}

.main-content .empty-feed i {
  font-size: 4rem;
  color: var(--color-text-muted);
  margin-bottom: var(--spacing-xl);
}

.main-content .empty-feed h3 {
  margin-bottom: var(--spacing-lg);
  color: var(--color-text);
  font-size: var(--font-xl);
}

.main-content .empty-feed p {
  color: var(--color-text-secondary);
  font-size: var(--font-base);
  margin: 0;
  line-height: 1.6;
}

.main-content .empty-feed a {
  color: var(--color-primary-light);
  text-decoration: none;
  font-weight: 600;
  transition: color var(--transition-base);
}

.main-content .empty-feed a:hover {
  color: var(--color-primary);
}

/* ===== TABLET RESPONSIVE - 481px to 768px ===== */
@media (min-width: 481px) and (max-width: 768px) {
  .main-content .posts-container {
    gap: var(--spacing-xl);
  }
  
  .main-content .post {
    margin: 0;
    padding: var(--spacing-2xl);
  }
  
  .main-content .post-header {
    gap: var(--spacing-md);
  }
  
  .main-content .post-avatar {
    width: 56px;
    height: 56px;
  }
  
  .main-content .author-name {
    font-size: var(--font-lg);
  }
  
  .main-content .author-username {
    font-size: var(--font-base);
  }
  
  .main-content .post-time {
    font-size: var(--font-base);
    padding: var(--spacing-sm) var(--spacing-md);
  }
  
  .main-content .post-time i {
    font-size: var(--font-sm);
  }
  
  .main-content .post-content p {
    font-size: var(--font-lg);
    margin-bottom: var(--spacing-xl);
  }
  
  .main-content .empty-feed {
    margin: 0;
    padding: 4rem var(--spacing-2xl);
  }
}

/* ===== DESKTOP RESPONSIVE - 769px and up ===== */
@media (min-width: 769px) {
  .main-content .posts-container {
    gap: var(--spacing-2xl);
    max-width: 900px;
  }
  
  .main-content .post {
    margin: 0;
    padding: var(--spacing-3xl);
  }
  
  .main-content .post-header {
    gap: var(--spacing-lg);
  }
  
  .main-content .post-avatar {
    width: 60px;
    height: 60px;
  }
  
  .main-content .post-author {
    flex: 1;
  }
  
  .main-content .author-name {
    font-size: var(--font-xl);
  }
  
  .main-content .author-username {
    font-size: var(--font-lg);
  }
  
  .main-content .post-time {
    font-size: var(--font-base);
    padding: var(--spacing-sm) var(--spacing-lg);
    background: rgba(255, 255, 255, 0.08);
  }
  
  .main-content .post-time i {
    font-size: var(--font-sm);
  }
  
  .main-content .post-content p {
    font-size: var(--font-lg);
    line-height: 1.8;
    margin-bottom: var(--spacing-2xl);
  }
  
  .main-content .empty-feed {
    margin: 0;
    padding: 5rem var(--spacing-3xl);
  }
  
  .main-content .empty-feed i {
    font-size: 5rem;
  }
  
  .main-content .empty-feed h3 {
    font-size: var(--font-2xl);
  }
  
  .main-content .empty-feed p {
    font-size: var(--font-lg);
  }
}

/* ===== MOBILE SPECIFIC - 480px and below ===== */
@media (max-width: 480px) {
  .main-content .posts-container {
    gap: var(--spacing-md);
  }
  
  .main-content .post {
    padding: var(--spacing-lg);
    margin: 0 var(--spacing-xs);
    border-radius: var(--radius-lg);
  }
  
  .main-content .post-header {
    gap: var(--spacing-sm);
  }
  
  .main-content .post-author {
    gap: var(--spacing-sm);
    min-width: 0;
  }
  
  .main-content .post-avatar {
    width: 44px;
    height: 44px;
  }
  
  .main-content .author-name {
    font-size: var(--font-sm);
  }
  
  .main-content .author-username {
    font-size: var(--font-xs);
  }
  
  .main-content .post-time {
    font-size: var(--font-xs);
    padding: var(--spacing-xs);
    border-radius: var(--radius-sm);
  }
  
  .main-content .post-time i {
    font-size: 10px;
  }
  
  .main-content .post-content {
    margin-bottom: var(--spacing-md);
  }
  
  .main-content .post-content p {
    font-size: var(--font-sm);
    line-height: 1.6;
    margin-bottom: var(--spacing-md);
  }
  
  .main-content .post-image img {
    border-radius: var(--radius-md);
  }
  
  .main-content .empty-feed {
    padding: var(--spacing-2xl) var(--spacing-lg);
  }
  
  .main-content .empty-feed i {
    font-size: 3rem;
    margin-bottom: var(--spacing-lg);
  }
  
  .main-content .empty-feed h3 {
    font-size: var(--font-lg);
    margin-bottom: var(--spacing-md);
  }
  
  .main-content .empty-feed p {
    font-size: var(--font-sm);
  }
}

/* ===== FEED HEADER ENHANCEMENT ===== */
.page-header h1 i {
  color: var(--color-primary);
}

/* ===== ACCESSIBILITY ENHANCEMENTS ===== */
@media (prefers-reduced-motion: reduce) {
  .main-content .post,
  .main-content .post-image img {
    transition: none;
  }
  
  .main-content .post:hover {
    transform: none;
  }
  
  .main-content .post-image img:hover {
    transform: none;
  }
}

/* ===== HIGH CONTRAST MODE ===== */
@media (prefers-contrast: high) {
  .main-content .post {
    border-width: 2px;
    border-color: rgba(255, 255, 255, 0.3);
  }
  
  .main-content .post-avatar {
    border-width: 3px;
  }
}
    </style>
</head>
<body>
    <div class="page-wrapper">
        <header class="page-header">
            <h1><i class="fas fa-newspaper"></i> Feed</h1>
        </header>

        <main class="main-content">
{% if posts %}
<div class="posts-container">
    {% for post in posts %}
    <div class="post card">
        <div class="post-header">
            <div class="post-author">
                {% if post.profile_picture %}
                    <img src="{{ url_for('static', filename='uploads/' + post.profile_picture) }}" alt="{{ post.username }}" class="post-avatar">
                {% else %}
                    <div class="avatar-placeholder small">{{ post.username[0]|upper }}</div>
                {% endif %}
                <div class="author-info">
    <a href="{{ url_for('profile', username=post.username) }}">
        <span class="author-name">{{ post.display_name or post.username }}
            {% if post.is_verified %}
            <span class="verified-badge" title="Akun Terverifikasi">
                <i class="fas fa-check-circle"></i>
            </span>
            {% endif %}
        </span>
    </a>
    <span class="author-username">@{{ post.username }}</span>
</div>
            </div>
            <span class="post-time"><i class="far fa-clock"></i> {{ format_datetime(post.created_at, 'relative') }}</span>
        </div>
        
        <div class="post-content">
            <p>{{ post.content }}</p>
            {% if post.image_path %}
                <div class="post-image">
                    <img src="{{ url_for('static', filename='uploads/' + post.image_path) }}" alt="Post image">
                </div>
            {% endif %}
        </div>
        
<div class="post-actions">
    <div class="like-item {{ 'liked' if post.is_liked else '' }}" onclick="toggleLike({{ post.id }}, this)" id="like-item-{{ post.id }}">
        <i class="{{ 'fas fa-heart' if post.is_liked else 'far fa-heart' }}"></i>
        <span class="count" id="like-count-{{ post.id }}">{{ post.like_count }}</span>
    </div>
    
    <div class="comment-item" onclick="openComments({{ post.id }})">
        <i class="far fa-comment"></i>
        <span class="count" id="comment-count-{{ post.id }}">{{ post.comment_count }}</span>
    </div>
</div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-feed card">
    <i class="fas fa-inbox"></i>
    <h3>Feed Anda masih kosong</h3>
    <p>Ikuti beberapa pengguna atau <a href="{{ url_for('create_post') }}">buat postingan pertama Anda</a>!</p>
</div>
{% endif %}
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <a href="{{ url_for('home') }}" class="nav-item">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </a>
            <a href="{{ url_for('search') }}" class="nav-item">
                <i class="fas fa-search"></i>
                <span>Cari</span>
            </a>
            <a href="{{ url_for('create_post') }}" class="nav-item">
                <i class="fas fa-plus-square"></i>
                <span>Posting</span>
            </a>
            <a href="{{ url_for('feed') }}" class="nav-item active">
                <i class="fas fa-newspaper"></i>
                <span>Feed</span>
            </a>
            <a href="{{ url_for('profile', username=session.username) }}" class="nav-item">
                <i class="fas fa-user"></i>
                <span>Profil</span>
            </a>
        </nav>
    </div>
    
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>